<body style="background-color: #121213;">


      <header style="display: flex; justify-content: space-between; align-items: center; background-color: #121213; padding: 10px;">
        <div style="background-color: #121213;">
          <button onClick="side_nav()" style="background-color: #121213; border: none; cursor: pointer;">
            <img src="../static/Screen Shot 2023-04-08 at 10.51.52 PM.png" style="height: 23px; width: fit-content; display: block; margin: auto;">
          </button>
        </div>
        <div style="display: flex; justify-content: center; flex-grow: 1; padding-right: 3%;">
          <b1 style="color: white; font-size: 30px;">Wôrdlé</b1>
        </div>
        

        
      </header>
      <hr style="opacity: 50%; border-width: 1px; color:rgb(179, 179, 179)">
      

      <div class="nav" style="display: none; height: calc(100% - 72px); width: 200px; position: fixed; z-index: 1; top: 72px; left: 0; background-color: #121213; border-right: 1px solid rgb(179, 179, 179, 0.5); overflow-x: hidden; padding-top: 20px;">
        <a href="#" style="padding: 6px 8px 6px 16px; text-decoration: none; font-size: 20px; color: #818181; display: block;">Home</a>
        <a href="#" style="padding: 6px 8px 6px 16px; text-decoration: none; font-size: 20px; color: #818181; display: block;">About</a>
        <a href="#" style="padding: 6px 8px 6px 16px; text-decoration: none; font-size: 20px; color: #818181; display: block;">Contact Us</a>
      </div>
      


      
      <div id="modal" style="display: none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4);">
        <div style="position: relative; border-radius: 10px; background-color: #121213; margin-top: 6%; margin-left: auto; margin-right: auto; height: 57%; width: 23%; padding: 70px; border: 1px solid rgb(136, 136, 136, 0.1);">
          <button  onclick="document.getElementById('modal').style.display='none'" style="position: absolute; top: 10px; right: 10px; background: #121213; border-width: 0px;" class="Modal-module_closeIcon__TcEKb" type="button" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24" class="game-icon" data-testid="icon-close"><path fill="white" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg></button>
          
          <div style="padding-left: 20px;"><h2 style="color: white; top: 0; margin-top: 0;">Statistics</h2></div>


          <div style="display: flex; width: 100%;">
            <div style="width: 25%; ">
              <div style="color: white; font-size: 40px; text-align: center;">4</div>
              <div style="color: white; font-size: 12px; text-align: center;">Played</div>
            </div>
            <div style="width: 25%; ">
              <div style="color: white; font-size: 40px; text-align: center;">75</div>
              <div style="color: white; font-size: 12px; text-align: center;">Win %</div>
            </div>
            <div style="width: 25%; ">
              <div style="color: white; font-size: 40px; text-align: center;">0</div>
              <div style="color: white; font-size: 12px; text-align: center;">Streak</div>
            </div>
            <div style="width: 25%; ">
              <div style="color: white; font-size: 40px; text-align: center;">0</div>
              <div style="color: white; font-size: 12px; text-align: center;">Max Streak</div>
            </div>
          </div>


          <div style="padding-top: 20px;">
            <div style="display: flex; align-items: center;justify-content: center; "> 
              <b1 style="font-size: 18px; font-weight: 20; color: white;">Leaderboard</b1>
            </div>
            {% for i in range(5) %}
              <div style="display: flex; align-items: center;justify-content: center; ">
                <b1 id="txt{{i}}"style="width: 94.3px; max-width: 94.3px; color: white; font-size: 12px;">AnonymousPerson</b1>
                <div style="margin-top: 10px; margin-left: 5px; border: 1px solid white; width: 200px; height: 15px;">
                  <div id="bar{{i}}"style="background-color: green; height: 15px; width: 50px;">

                  </div>
                </div>

              </div>

            {% endfor %}
          </div>

          <div style="position: absolute; bottom: 125; margin-top: 25px; left: 25%; display: flex; justify-content: center; align-items: center;">
            <label for="username" style="font-weight: bold; color: white; margin-right: 5px;">Username:</label>
            <input type="text" id="username" name="username" style=" border-radius: 10px; padding: 5px; border: 1px solid black;">
          </div>
          


          

          <div style="position: absolute; bottom: 75px; left: 50%; transform: translateX(-50%);">
            <button type="button" style="display: flex; align-items: center; justify-content: center; background-color: green; border: none; border-radius: 20px; width: 125px; height: 40px;" onclick="shareUser()">
              <span style="color: white; margin-right: 15px;">Share</span>
              <svg id="AuthCTA-module_shareIcon__WGE7Z" xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24" class="game-icon" data-testid="icon-share">
                <path fill="white" d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92c0-1.61-1.31-2.92-2.92-2.92zM18 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM6 13c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm12 7.02c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"></path>
              </svg>
            </button>
          </div>
          
          



        </div>
      </div>
      


    <main>
        <div style="margin-top: 1%; display: flex; justify-content: center; align-items: center;">
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; padding: 10px; align-items: center;">
              {% for row in range(6) %}
                {% for col in range(5) %}
                <div id="d{{ row ~ col }}" style="background-color:#121213; border: 1px solid rgb(179, 179, 179); width: 60px; height: 60px; display: flex; justify-content: center; align-items: center;">
                    <b1 id="c{{ row ~ col }}"class="c{{ row ~ col }}" style="backface-visibility: hidden; color: white; font-size: 32px;"></b1>
                  </div>
                  
                
                {% endfor %}
              {% endfor %}
            </div>
          </div>




          <div style="width: 100%; margin-top: 50px; align-items: center; justify-content: center; text-align: center;">
            {% for row in letters %}
              <div style="display: flex; padding-bottom: 10px; justify-content: center; text-align: center;">
                {% for letter in row %}


                <button style="cursor: pointer; margin: 0; padding: 0; background: none; border: none;" onClick="handle('{{letter}}')">

                {% if letter != 'DELETE' %}
                  <div class="letter" id="{{letter}}" style="margin-left: 5px; margin-right: 5px; background:#818181; padding: 10px 10px; height: 40px; border-radius: 5px; align-items: center; line-height: 40px"><b1 style="font-family: nyt-franklin; font-size: 20px; color: white; line-height: 40px">{{letter}}</b1></div>
                {% else %}
                <div class="letter-del" id="{{letter}}" style="margin-left: 5px; margin-right: 5px; background:#818181; padding: 10px 10px; height: 40px; border-radius: 5px; align-items: center; line-height: 40px"><svg xmlns="http://www.w3.org/2000/svg" style="justify-content: center; align-items: center;" height="24" viewBox="0 0 24 24" width="24" class="game-icon" data-testid="icon-backspace"><path fill="white" d="M22 3H7c-.69 0-1.23.35-1.59.88L0 12l5.41 8.11c.36.53.9.89 1.59.89h15c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H7.07L2.4 12l4.66-7H22v14zm-11.59-2L14 13.41 17.59 17 19 15.59 15.41 12 19 8.41 17.59 7 14 10.59 10.41 7 9 8.41 12.59 12 9 15.59z"></path></svg></div>

                {% endif %}
              </button>


                {% endfor %}
              </div>
            {% endfor %}
          </div>
          
    </main>

    <style>
        .letter {
          width: auto;
          min-width: 25px;
        }

        .letter-del {
  width: auto;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 50px;
}


button:focus {
  outline: none;
}


        @keyframes slide {
          0% { transform: translateX(-3px); }
          25% { transform: translateX(3px); }
          50% { transform: translateX(-3px); }
          75% { transform: translateX(3px); }
          100% { transform: translateX(0); }
        }
        
        .slide-animation {
          animation: slide 0.25s ease-in-out infinite;
        }
      </style>
            
      
    
    <script>
        document.addEventListener("keydown", event => {
        
        console.log("FOUND KEY");
        const key = event.key.toLowerCase();

        handle(key);

    });

    </script>


    <script>

      var nav = false;

      function side_nav(){
        nav = !nav;

        const myDiv = document.querySelector('.nav');

        if (nav){
          myDiv.style.display = "block";
        } else {
          myDiv.style.display = "none";
        }
        
      }

      function letterClick(){

      }

      function handle(key){
        key = key.toLowerCase();
        if (key == "delete") key = "backspace";
        console.log("HANDLE KEY"+key)
        const xhttp = new XMLHttpRequest();

        xhttp.onreadystatechange = function() {
            if (this.readyState === 4 && this.status === 200) {
                console.log(this.responseText);
                var response = JSON.parse(this.responseText);
                  
                if (response[0] == -1){
                    var row = response[1];
                    for(let i = 0; i < 5; i++){
                        document.getElementById("d"+row.toString()+i.toString()).classList.add("slide-animation");
                    }
                    setTimeout(() => {
                        for(let i = 0; i < 5; i++){
                            document.getElementById("d"+row.toString()+i.toString()).classList.remove("slide-animation");
                        }
                    }, 250);

                    
                } else {
                  var count = 0;
                    for (let i = 0; i < response[0]; i++){
                        console.log("."+response[1+i*3]);
                        var element = document.querySelector(".c" + response[1+i*3]);
                        if (response[3+i*3] == 'green') count += 1;
                        document.getElementById("d" + response[1+i*3]).style.backgroundColor = response[3+i*3];
                        element.textContent = response[2+i*3]
                        if (response[0] > 1) document.getElementById(response[2+i*3]).style.backgroundColor = response[3+i*3];
                    }
          

                    if (count == 5){

                      for (let i = 0; i < 5; i++){
                        setTimeout(() => {
                          document.getElementById("d" + response[1+i*3]).classList.add("flip-animation");
                          document.getElementById("c" + response[1+i*3]).classList.add("flip-animation2");
                        }, 400*i);
                      }
                      
                      setTimeout(() => {
                        document.getElementById('modal').style.display = 'block';
                      }, 2750);
                      for (let i = 0; i < 5; i++){
                        getLeaderboard(i);
                      }
                    }
                  }

                
                
                
            }
            

            
        };

        xhttp.open("POST", "/", true);
        xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        xhttp.send(`keypress=${key}&id=${"key"}`);
      }


      function getLeaderboard(index){
        console.log("LOADED")
        const xhttp = new XMLHttpRequest();
        
        xhttp.onreadystatechange = function() {
          if (this.readyState === 4 && this.status === 200) {
            console.log(this.responseText);
            var response = JSON.parse(this.responseText);

            var name = response[0];
            var score = response[1];

            console.log('.txt'+index)
            const mytext = document.getElementById('txt'+index);
            const mybar = document.getElementById('bar'+index);

            console.log(mybar)
            mybar.style.width = score*2;
            mytext.textContent = name;



            


          }
        }

        xhttp.open("POST", "/leader", true);
        xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        xhttp.send(`index=${index}`);
      }


      function shareUser(){
        const username = document.getElementById("username").value;


        const xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
          for (let i = 0; i < 5; i++){
            getLeaderboard(i);
          }
 
        };

        xhttp.open("POST", "/addscore", true);
        xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        xhttp.send(`username=${username}`);
      }

    </script>

<style>

  @keyframes flip {
    0% { transform: rotateX(180deg); }
    100% {transform: rotateX(360deg);}
  }

  @keyframes flip2 {
    0% { transform: rotateX(180deg); }
    100% {transform: rotateX(0deg);}
  }



  .flip-animation {
    animation-name: flip;
    animation-duration: .5s; /* duration of animation */
    animation-fill-mode: forwards; /* keep final height after animation ends */
    animation-direction: alternate; /* play animation forwards, then backwards */

  }
  .flip-animation2 {
    animation-name: flip2;
    animation-duration: .5s; /* duration of animation */
    animation-fill-mode: forwards; /* keep final height after animation ends */
    animation-direction: alternate; /* play animation forwards, then backwards */

  }

  
</style>

</body>
